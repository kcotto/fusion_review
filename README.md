## Step-by-step instructions
Start by opening a Terminal session on your local system

### Set some Google Cloud and other environment variables on your local system
The following environment variables are used merely for convenience and should be customized to produce intuitive labeling for your own analysis:

```bash
export GCS_PROJECT=jlf-rcrf
export GCS_SERVICE_ACCOUNT=cromwell-server@$GCS_PROJECT.iam.gserviceaccount.com
export GCS_BUCKET_NAME=jlf-rcrf-immuno-outputs
export GCS_BUCKET_PATH=gs://$GCS_BUCKET_NAME
export GCS_CASE_NAME=jlf-100-044
export WORKING_BASE=~/Desktop/rcrf/$GCS_CASE_NAME
```

### Login to GCP and set the desired project on your local system
From the command line, you will need to authenticate your cloud access (using your google cloud account credentials). This generally only needs to be done once, though there is no harm to re-authenticating. The login command below will generate a custom URL to enter in your browser. Once you do this, you will be prompted to log into your Google account. If you have multiple Google accounts (e.g. one for your institution/company and a personal one) be sure to use the correct one.  Once you have logged in you will be presented with a long code. Enter this at the prompt generated by the login command below. Finally, set your desired Google Project. This Project should correspond to a Google Billing account in the Google console. If you are using Google Cloud for the first time, both billing and a project should be set up before proceeding. Configuring billing alerts is also probably wise at this point.
```bash
gcloud auth login
gcloud config set project $GCS_PROJECT
gcloud config list
```

## Local setup

### First create a working directory on your local system
The following directory on the local system will contain: (a) a git repository for the WDL workflows, including the immuno worflow, (b) a git repository for tools that help provision and manage our workflow runs on the cloud.

```bash
mkdir -p $WORKING_BASE
cd $WORKING_BASE
mkdir final_results
cd final_results
```

### Download relevant output files
This analysis requires files from pVACfuse and rnaseq directories from the final results.

```bash
gsutil -m cp -r \
  "gs://jlf-rcrf-immuno-outputs/JLF-100-038-v2/final_results/final_results_BG/pVACfuse" \
  .
```

```bash
mkdir rnaseq
cd rnaseq
gsutil -m rsync -r -x '.*\.(bam|bai)$' gs://jlf-rcrf-immuno-outputs/JLF-100-038-v2/final_results/final_results_BG/rnaseq .
```

```bash
python3 filter_fusions.py -WB  $WORKING_BASE -f final_results
```
